{% extends 'store/index.html.twig' %}

{% block content %}
    <div class="album py-3 bg-light">
        <div class="container">
            {# Breadcrumb #}
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb bg-light">
                    <li class="breadcrumb-item" aria-current="page"><a href="{{ path('home') }}">Oponet</a></li>
                    <li class="breadcrumb-item" aria-current="page"><a href="{{ path('show_brand', { slug: model.brand.slug }) }}">{{ model.brand.name }}</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{ model.name }}</li>
                </ol>
            </nav>
            {# Model description #}
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow">
                        <div class="row no-gutters align-items-center">
                            <div class="col-md-3">
                                <div class="carousel slide" data-ride="carousel">
                                    <div class="carousel-inner">
                                        {% for image in model.imagesPaths %}
                                            <div class="carousel-item {% if loop.first %}active{% endif %}">
                                                <img src="{{ asset(image) }}" class="d-block w-100">
                                            </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            {% if model.description %}
                                <div class="col-md-9">
                                    <div class="card-body">
                                        {{ model.description|markdown_to_html }}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-12">
                    {% if products|length < 1 %}
                    <div class="alert alert-danger" role="alert">
                        We have not found any products matching your search, try again with other parameters
                    </div>
                    {% else %}
                    <div class="card text-dark mb-3 bg-light shadow">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <div>
                                <i class="bi bi-list-check mr-2"></i>
                                AVAILABLE SIZES
                            </div>
                            <div class="btn-toolbar mb-2 mb-md-0">
                                <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="bi bi-funnel"></i>
                                    {% if products.isSorted('p.price') %}
                                        Price
                                    {% else %}
                                        Sort by
                                    {% endif %}
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                    <div class="d-flex flex-row align-items-center">
                                        <div class="d-flex flex-column ml-2">
                                            <i class="bi bi-cash"></i>
                                        </div>
                                        <div class="d-flex flex-column ml-2">
                                            {{ knp_pagination_sortable(products, 'Low High', 'p.price', {'sort': 'p.price', 'direction' : 'asc', 'class' : 'text-dark' }) }}
                                        </div>
                                        <div class="d-flex flex-column mr-2 ml-auto">
                                            <i class="bi bi-sort-down-alt"></i>
                                        </div>
                                    </div>
                                    <div class="d-flex flex-row align-items-center">
                                        <div class="d-flex flex-column ml-2">
                                            <i class="bi bi-cash"></i>
                                        </div>
                                        <div class="d-flex flex-column ml-2">
                                            {{ knp_pagination_sortable(products, 'High Low', 'p.price', {'sort': 'p.price', 'direction' : 'desc', 'class' : 'text-dark' }) }}
                                        </div>
                                        <div class="d-flex flex-column mr-2 ml-auto">
                                            <i class="bi bi-sort-down"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-light table-striped">
                                <thead>
                                <tr>
                                    <th scope="col">Size</th>
                                    <th scope="col">Symbol</th>
                                    <th scope="col">Price</th>
                                    <th scope="col">Year</th>
                                    <th scope="col" style="width: 5%">Show</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for product in products %}
                                    <tr>
                                        <td class="align-middle">
                                            {{ product.width }}/{{ product.height }} R{{ product.rimSize }} {% if product.reinforced %}XL{% endif %}
                                        </td>
                                        <td class="align-middle">{{ product.loadIndex }}{{ product.speedRating }}</td>
                                        <td class="align-middle">{{ product.price }}</td>
                                        <td class="align-middle">{{ product.year }}</td>
                                        <td class="align-middle">
                                            <a class="btn btn-outline-success" href="{{ path('show_product', { slug: product.slug }) }}">
                                                <i class="bi bi-search"></i>
                                            </a>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        {% if knp_pagination_render(products) %}
                            <div class="card-footer d-flex justify-content-center align-items-center">
                                {{ knp_pagination_render(products) }}
                            </div>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}