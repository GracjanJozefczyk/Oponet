{% extends 'store/index.html.twig' %}

{% block content %}

{% include 'store/_search.html.twig' %}

<div class="album py-4 bg-light">
    <div class="container">

        <table>
            <tr>
            </tr>
        </table>


        <div class="row">
            <div class="col">
                <div class="card text-dark mb-3 bg-light shadow">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <div>
                            <i class="bi bi-list-check mr-2"></i>
                            We have found <b>{{ products|length }}</b> products from <b>{{ minPrice }}</b> to <b>{{ maxPrice }}</b> zł
                        </div>
                        <div class="btn-toolbar mb-2 mb-md-0">
                            <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="bi bi-funnel"></i>
                                {% if products.isSorted('t.price') %}
                                Price
                                {% elseif products.isSorted('b.name') %}
                                Brand
                                {% else %}
                                Sort by
                                {% endif %}
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">

                                <div class="d-flex flex-row align-items-center">
                                    <div class="d-flex flex-column ml-2">
                                        <i class="bi bi-cash"></i>
                                    </div>
                                    <div class="d-flex flex-column ml-2">
                                        {{ knp_pagination_sortable(products, 'Price', 't.price', {'sort': 't.price', 'direction' : 'asc', 'class' : 'text-dark' }) }}
                                    </div>
                                    <div class="d-flex flex-column mr-2 ml-auto">
                                        <i class="bi bi-sort-numeric-down"></i>
                                    </div>
                                </div>

                                <div class="d-flex flex-row align-items-center">
                                    <div class="d-flex flex-column ml-2">
                                        <i class="bi bi-cash"></i>
                                    </div>
                                    <div class="d-flex flex-column ml-2">
                                        {{ knp_pagination_sortable(products, 'Price', 't.price', {'sort': 't.price', 'direction' : 'desc', 'class' : 'text-dark' }) }}
                                    </div>
                                    <div class="d-flex flex-column mr-2 ml-auto">
                                        <i class="bi bi-sort-numeric-down-alt"></i>
                                    </div>
                                </div>

                                <div class="d-flex flex-row align-items-center">
                                    <div class="d-flex flex-column ml-2">
                                        <i class="bi bi-tag-fill"></i>
                                    </div>
                                    <div class="d-flex flex-column ml-2">
                                        {{ knp_pagination_sortable(products, 'Brand', 'b.name', {'sort': 'b.name', 'direction' : 'asc', 'class' : 'text-dark' }) }}
                                    </div>
                                    <div class="d-flex flex-column mr-2 ml-auto">
                                        <i class="bi bi-sort-alpha-down"></i>
                                    </div>
                                </div>

                                <div class="d-flex flex-row align-items-center">
                                    <div class="d-flex flex-column ml-2">
                                        <i class="bi bi-tag-fill"></i>
                                    </div>
                                    <div class="d-flex flex-column ml-2">
                                        {{ knp_pagination_sortable(products, 'Brand', 'b.name', {'sort': 'b.name', 'direction' : 'desc', 'class' : 'text-dark' }) }}
                                    </div>
                                    <div class="d-flex flex-column mr-2 ml-auto">
                                        <i class="bi bi-sort-alpha-down-alt"></i>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
           {% for product in products %}
           <div class="col-sm-4">
               <div class="card mb-4 shadow">
                   <div class="card-header">
                       {{ product.model.brand.name }} {{ product.model.name }}
                   </div>
                   <a href="{{ path('show_product', { slug: product.slug }) }}">
                       <div class="carousel slide carousel-fade" data-ride="carousel">
                           <div class="carousel-inner">
                               {% for image in product.model.imagesPaths %}
                                   <div class="carousel-item {% if loop.first %}active{% endif %}">
                                       <img src="{{ asset(image) }}" class="d-block w-100">
                                   </div>
                               {% endfor %}
                           </div>
                       </div>
                   </a>
                   <div class="card-body pt-0 px-0">
                       <div class="d-flex flex-row justify-content-between mb-0 px-3">
                           <small class="text-muted mt-1">{{ product.width }}/{{ product.height }} R{{ product.rimSize }}</small>
                           <h6>{{ product.price }} zł/pcs</h6>
                       </div>
                       <hr class="mt-2 mx-3">
                       <div class="d-flex flex-row justify-content-between px-3 pb-4">
                           <div class="d-flex flex-column">
                               <span class="text-muted">LOAD INDEX</span>
                               <small class="text-muted">Max.</small>
                           </div>
                           <div class="d-flex flex-column">
                               <div class="d-flex flex-row justify-content-around">
                                   <i class="bi bi-download"></i>
                                   <h5 class="mb-0">{{ product.loadIndex }}</h5>
                               </div>
                               <small class="text-muted text-right">{{ product.loadIndex.kg }}kg/{{ product.loadIndex.lbs }}lbs</small>
                           </div>
                       </div>
                       <hr class="mt-2 mx-3">
                       <div class="d-flex flex-row justify-content-between px-3 pb-4">
                           <div class="d-flex flex-column">
                               <span class="text-muted">SPEED RATING</span>
                               <small class="text-muted">Max.</small>
                           </div>
                           <div class="d-flex flex-column">
                               <div class="d-flex flex-row justify-content-around">
                                   <i class="bi bi-speedometer"></i>
                                   <h5 class="mb-0">{{ product.speedRating }}</h5>
                               </div>
                               <small class="text-muted text-right">{{ product.speedRating.kmh }}kmh/{{ product.speedRating.mph }}mph</small>
                           </div>
                       </div>
                       <div class="d-flex flex-row justify-content-between p-3" style="background: #ECEDF1">
                           <div class="d-flex flex-column align-items-center">
                               <small class="text-muted mb-2">EFFICIENCY</small>
                               <div class="d-flex flex-row">
                                   <i class="bi-droplet-half"></i>
                                   <h6 class="ml-1">{{ product.fuelEfficiency }}</h6>
                               </div>
                           </div>
                           <div class="d-flex flex-column align-items-center">
                               <small class="text-muted mb-2">GRIP</small>
                               <div class="d-flex flex-row">
                                   <i class="bi-cloud-drizzle-fill"></i>
                                   <h6 class="ml-1">{{ product.wetGrip }}</h6>
                               </div>
                           </div>
                           <div class="d-flex flex-column align-items-center">
                               <small class="text-muted mb-2">NOISE</small>
                               <div class="d-flex flex-row">
                                   <i class="bi-megaphone-fill"></i>
                                   <h6 class="ml-1">{{ product.noiseLevel }}</h6>
                               </div>
                           </div>
                       </div>
                       <div class="d-flex flex-row justify-content-between align-items-center px-3 py-4">
                           <div class="d-flex flex-column flex-fill mr-2">
                               <div class="progress">
                                   <div class="progress-bar {% if product.quantity < 4 %}bg-danger{% elseif product.quantity > 7 %}bg-success{% else %}bg-warning{% endif %}"
                                        style="width: {% if product.quantity < 4 %}20{% elseif product.quantity > 7 %}90{% else %}50{% endif %}%">
                                       {{ product.quantity }} pcs
                                   </div>
                               </div>
                           </div>
                           <div class="d-flex flex-column flex-fill ml-2">
                               <select class="form-control form-control-sm">
                                   {% for i in 1..product.quantity %}
                                       <option>{{ i }}</option>
                                   {% endfor %}
                               </select>
                           </div>
                       </div>
                       <div class="mx-3 mb-2">
                           <button type="button" class="btn btn-danger btn-block"><small>ADD TO CART</small></button>
                       </div>
                   </div>
               </div>
           </div>
           {% endfor %}
        </div>

        <div class="row">
            <div class="col">
                <div class="card text-dark mb-3 bg-light shadow">
                    <div class="card-header d-flex justify-content-center align-items-center">
                        {{ knp_pagination_render(products) }}
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}